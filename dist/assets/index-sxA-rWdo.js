import{c as M,J as V,h as B,i as N,K as F,a5 as H,r as c,N as q,a6 as Y,j as e,u as _,B as f,V as z,R as b,C as d,e as m,U as S,b as w,d as R}from"./index-DFBcCm7V.js";import{S as T,a as k,b as C,c as A,d as j}from"./select-CERIiCGz.js";import{L as D}from"./label-DDo3gBiT.js";import{T as J}from"./trending-up-BxQhK-q7.js";import{E as L}from"./eye-rqfbY1ip.js";import"./index-DvoRuxMr.js";import"./index-DSUgCejY.js";const K=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],O=M("user-check",K),P=()=>{const{id:t}=V(),l=B(),n=N(F),r=N(a=>t?H(t)(a):[]),i=N(a=>a.survey.isLoading||a.response.isLoading),[h,p]=c.useState("all"),[u,g]=c.useState("all");c.useEffect(()=>{t&&(l(q(t)),l(Y(t)))},[t,l]);const o=c.useMemo(()=>{const a=r.length,v=r.filter(I=>I.anonymous).length,U=a-v,E=a>0?Math.min(100,a/50*100):0;return{totalResponses:a,anonymousCount:v,namedCount:U,responseRate:Math.round(E)}},[r]),x=c.useMemo(()=>r,[r,h,u]),y=c.useMemo(()=>n?.targetAudience.teams||[],[n]),s=c.useMemo(()=>n?.targetAudience.departments||[],[n]);return{survey:n,responses:x,isLoading:i,stats:o,filterTeam:h,setFilterTeam:p,filterDepartment:u,setFilterDepartment:g,availableTeams:y,availableDepartments:s}};function $(){return e.jsxs("div",{className:"space-y-6 animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map(t=>e.jsx("div",{className:"h-24 bg-gray-200 rounded-lg"},t))}),e.jsx("div",{className:"h-12 bg-gray-200 rounded"}),e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-20 bg-gray-200 rounded-lg"},t))})]})}function te(){const t=_(),{survey:l,responses:n,isLoading:r,stats:i,filterTeam:h,setFilterTeam:p,filterDepartment:u,setFilterDepartment:g,availableTeams:o,availableDepartments:x}=P();if(r||!l)return e.jsx($,{});const y=s=>{try{return new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return s}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"Response Tracking"}),e.jsx("p",{className:"text-gray-600 mt-1",children:l.title})]}),e.jsxs(f,{variant:"outline",onClick:()=>t(b.SURVEYS.LIST),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Back to Surveys"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Responses"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:i.totalResponses})]}),e.jsx(S,{className:"w-8 h-8 text-primary"})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Response Rate"}),e.jsxs("p",{className:"text-2xl font-bold mt-1",children:[i.responseRate,"%"]})]}),e.jsx(J,{className:"w-8 h-8 text-green-500"})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Named Responses"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:i.namedCount})]}),e.jsx(O,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(d,{children:e.jsx(m,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Anonymous"}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:i.anonymousCount})]}),e.jsx(L,{className:"w-8 h-8 text-gray-500"})]})})})]}),(o.length>0||x.length>0)&&e.jsxs(d,{children:[e.jsx(w,{children:e.jsx(R,{children:"Filters"})}),e.jsx(m,{children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[o.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Team"}),e.jsxs(T,{value:h,onValueChange:p,children:[e.jsx(k,{className:"w-[180px]",children:e.jsx(C,{placeholder:"All Teams"})}),e.jsxs(A,{children:[e.jsx(j,{value:"all",children:"All Teams"}),o.map(s=>e.jsx(j,{value:s,children:s},s))]})]})]}),x.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(D,{children:"Department"}),e.jsxs(T,{value:u,onValueChange:g,children:[e.jsx(k,{className:"w-[180px]",children:e.jsx(C,{placeholder:"All Departments"})}),e.jsxs(A,{children:[e.jsx(j,{value:"all",children:"All Departments"}),x.map(s=>e.jsx(j,{value:s,children:s},s))]})]})]})]})})]}),e.jsxs(d,{children:[e.jsx(w,{children:e.jsxs(R,{children:["Responses (",n.length,")"]})}),e.jsx(m,{children:n.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(S,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"No responses yet"}),e.jsx("p",{className:"text-sm mt-2",children:"Share the survey link to start collecting responses"})]}):e.jsx("div",{className:"space-y-4",children:n.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.anonymous?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Anonymous"}),s.respondentName&&e.jsxs("span",{className:"text-sm text-gray-500",children:["(",s.respondentName,")"]})]}):e.jsxs("span",{className:"text-sm font-medium",children:["User ID: ",s.userId||"Unknown"]}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${s.anonymous?"bg-gray-100 text-gray-700":"bg-blue-100 text-blue-700"}`,children:s.anonymous?"Anonymous":"Named"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Submitted: ",y(s.submittedAt)]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Answers: ",s.answers.length," / ",l.questions.length]})]}),e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>t(b.SURVEYS.RESULTS.replace(":id",l.id)),children:[e.jsx(L,{className:"w-4 h-4 mr-1"}),"View Results"]})]})},s.id))})})]})]})}export{te as default};
