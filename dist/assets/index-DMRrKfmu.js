import{c as D,j as e,r as i,t as me,v as pe,w as ge,x as b,y as T,P as N,z as v,A as P,D as fe,E as xe,F as he,G as C,B as g,f as x,u as V,q as B,C as R,b as ye,d as je,e as w,U as ve,S as y,R as j,h as G,i as _,k as H,H as Ne,I as Ce,o as O}from"./index-DFBcCm7V.js";import{h as Se,R as De,u as Ee,F as be}from"./index-DSUgCejY.js";import{X as Re}from"./x-DKR4CodG.js";import{I as L}from"./input-Cn8rvVGd.js";import{L as F,C as we}from"./label-DDo3gBiT.js";import{C as _e,c as Te,a as M,b as Pe,S as Ae,d as $,e as Ie}from"./permissionsUtil-CwlnOHuT.js";import{T as ke,P as z}from"./trash-2-st2Kg0im.js";import{E as Oe}from"./eye-rqfbY1ip.js";import{C as Le}from"./chart-column-D3x7IYAi.js";import{M as U,g as W}from"./messages-keBJKTKK.js";import{S as Fe}from"./search-Y32gwDqf.js";const Me=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],$e=D("copy",Me);const ze=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Ue=D("link",ze);const We=[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]],Ve=D("mail",We);const Be=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Ge=D("send",Be);function He(){return e.jsxs("div",{className:"space-y-6 animate-pulse",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-64"})]}),e.jsx("div",{className:"h-10 bg-gray-200 rounded w-32"})]}),e.jsx("div",{className:"h-12 bg-gray-200 rounded"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-64 bg-gray-200 rounded-lg"},t))})]})}function qe(t){const s=Ye(t),n=i.forwardRef((r,a)=>{const{children:o,...c}=r,l=i.Children.toArray(o),u=l.find(Ze);if(u){const m=u.props.children,d=l.map(f=>f===u?i.Children.count(m)>1?i.Children.only(null):i.isValidElement(m)?m.props.children:null:f);return e.jsx(s,{...c,ref:a,children:i.isValidElement(m)?i.cloneElement(m,void 0,d):null})}return e.jsx(s,{...c,ref:a,children:o})});return n.displayName=`${t}.Slot`,n}function Ye(t){const s=i.forwardRef((n,r)=>{const{children:a,...o}=n;if(i.isValidElement(a)){const c=Xe(a),l=Qe(o,a.props);return a.type!==i.Fragment&&(l.ref=r?me(r,c):c),i.cloneElement(a,l)}return i.Children.count(a)>1?i.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Ke=Symbol("radix.slottable");function Ze(t){return i.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Ke}function Qe(t,s){const n={...s};for(const r in s){const a=t[r],o=s[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...l)=>{const u=o(...l);return a(...l),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...t,...n}}function Xe(t){let s=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=s&&"isReactWarning"in s&&s.isReactWarning;return n?t.ref:(s=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=s&&"isReactWarning"in s&&s.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var E="Dialog",[q]=ge(E),[Je,p]=q(E),Y=t=>{const{__scopeDialog:s,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:c=!0}=t,l=i.useRef(null),u=i.useRef(null),[m,d]=pe({prop:r,defaultProp:a??!1,onChange:o,caller:E});return e.jsx(Je,{scope:s,triggerRef:l,contentRef:u,contentId:b(),titleId:b(),descriptionId:b(),open:m,onOpenChange:d,onOpenToggle:i.useCallback(()=>d(f=>!f),[d]),modal:c,children:n})};Y.displayName=E;var K="DialogTrigger",Z=i.forwardRef((t,s)=>{const{__scopeDialog:n,...r}=t,a=p(K,n),o=T(s,a.triggerRef);return e.jsx(N.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":k(a.open),...r,ref:o,onClick:v(t.onClick,a.onOpenToggle)})});Z.displayName=K;var A="DialogPortal",[et,Q]=q(A,{forceMount:void 0}),X=t=>{const{__scopeDialog:s,forceMount:n,children:r,container:a}=t,o=p(A,s);return e.jsx(et,{scope:s,forceMount:n,children:i.Children.map(r,c=>e.jsx(P,{present:n||o.open,children:e.jsx(fe,{asChild:!0,container:a,children:c})}))})};X.displayName=A;var S="DialogOverlay",J=i.forwardRef((t,s)=>{const n=Q(S,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,o=p(S,t.__scopeDialog);return o.modal?e.jsx(P,{present:r||o.open,children:e.jsx(st,{...a,ref:s})}):null});J.displayName=S;var tt=qe("DialogOverlay.RemoveScroll"),st=i.forwardRef((t,s)=>{const{__scopeDialog:n,...r}=t,a=p(S,n);return e.jsx(De,{as:tt,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(N.div,{"data-state":k(a.open),...r,ref:s,style:{pointerEvents:"auto",...r.style}})})}),h="DialogContent",ee=i.forwardRef((t,s)=>{const n=Q(h,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,o=p(h,t.__scopeDialog);return e.jsx(P,{present:r||o.open,children:o.modal?e.jsx(at,{...a,ref:s}):e.jsx(nt,{...a,ref:s})})});ee.displayName=h;var at=i.forwardRef((t,s)=>{const n=p(h,t.__scopeDialog),r=i.useRef(null),a=T(s,n.contentRef,r);return i.useEffect(()=>{const o=r.current;if(o)return Se(o)},[]),e.jsx(te,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:v(t.onCloseAutoFocus,o=>{o.preventDefault(),n.triggerRef.current?.focus()}),onPointerDownOutside:v(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,l=c.button===0&&c.ctrlKey===!0;(c.button===2||l)&&o.preventDefault()}),onFocusOutside:v(t.onFocusOutside,o=>o.preventDefault())})}),nt=i.forwardRef((t,s)=>{const n=p(h,t.__scopeDialog),r=i.useRef(!1),a=i.useRef(!1);return e.jsx(te,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||n.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const c=o.target;n.triggerRef.current?.contains(c)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),te=i.forwardRef((t,s)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...c}=t,l=p(h,n),u=i.useRef(null),m=T(s,u);return Ee(),e.jsxs(e.Fragment,{children:[e.jsx(be,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:e.jsx(xe,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":k(l.open),...c,ref:m,onDismiss:()=>l.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(rt,{titleId:l.titleId}),e.jsx(it,{contentRef:u,descriptionId:l.descriptionId})]})]})}),I="DialogTitle",se=i.forwardRef((t,s)=>{const{__scopeDialog:n,...r}=t,a=p(I,n);return e.jsx(N.h2,{id:a.titleId,...r,ref:s})});se.displayName=I;var ae="DialogDescription",ne=i.forwardRef((t,s)=>{const{__scopeDialog:n,...r}=t,a=p(ae,n);return e.jsx(N.p,{id:a.descriptionId,...r,ref:s})});ne.displayName=ae;var re="DialogClose",oe=i.forwardRef((t,s)=>{const{__scopeDialog:n,...r}=t,a=p(re,n);return e.jsx(N.button,{type:"button",...r,ref:s,onClick:v(t.onClick,()=>a.onOpenChange(!1))})});oe.displayName=re;function k(t){return t?"open":"closed"}var ie="DialogTitleWarning",[Ft,le]=he(ie,{contentName:h,titleName:I,docsSlug:"dialog"}),rt=({titleId:t})=>{const s=le(ie),n=`\`${s.contentName}\` requires a \`${s.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${s.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${s.docsSlug}`;return i.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},ot="DialogDescriptionWarning",it=({contentRef:t,descriptionId:s})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${le(ot).contentName}}.`;return i.useEffect(()=>{const a=t.current?.getAttribute("aria-describedby");s&&a&&(document.getElementById(s)||console.warn(r))},[r,t,s]),null},lt=Y,ct=Z,dt=X,ut=J,mt=ee,pt=se,gt=ne,ft=oe;function xt({...t}){return e.jsx(lt,{"data-slot":"dialog",...t})}function ht({...t}){return e.jsx(ct,{"data-slot":"dialog-trigger",...t})}function yt({...t}){return e.jsx(dt,{"data-slot":"dialog-portal",...t})}const ce=i.forwardRef(({className:t,...s},n)=>e.jsx(ut,{ref:n,"data-slot":"dialog-overlay",className:C("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s}));ce.displayName="DialogOverlay";function jt({className:t,children:s,...n}){return e.jsxs(yt,{"data-slot":"dialog-portal",children:[e.jsx(ce,{}),e.jsxs(mt,{"data-slot":"dialog-content",className:C("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg p-6 shadow-xl duration-200 sm:max-w-lg",t),...n,children:[s,e.jsxs(ft,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(Re,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function vt({className:t,...s}){return e.jsx("div",{"data-slot":"dialog-header",className:C("flex flex-col gap-2 text-center sm:text-left",t),...s})}function Nt({className:t,...s}){return e.jsx(pt,{"data-slot":"dialog-title",className:C("text-lg leading-none font-semibold",t),...s})}function Ct({className:t,...s}){return e.jsx(gt,{"data-slot":"dialog-description",className:C("text-muted-foreground text-sm",t),...s})}function St({survey:t,trigger:s}){const[n,r]=i.useState(!1),[a,o]=i.useState(""),c=`${window.location.origin}/surveys/${t.id}/respond`,l=async()=>{try{await navigator.clipboard.writeText(c),r(!0),x.success("Link copied to clipboard"),setTimeout(()=>r(!1),2e3)}catch{x.error("Failed to copy link")}},u=()=>{const m=a.split(",").map(d=>d.trim()).filter(Boolean);if(m.length===0){x.error("Please enter at least one email address");return}x.success(`Would send survey to ${m.length} email(s)`),o("")};return e.jsxs(xt,{children:[e.jsx(ht,{asChild:!0,children:s||e.jsxs(g,{variant:"outline",size:"sm",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"Share"]})}),e.jsxs(jt,{className:"sm:max-w-[500px]",children:[e.jsxs(vt,{children:[e.jsx(Nt,{children:"Share Survey"}),e.jsx(Ct,{children:"Share this survey with your team members. They can access it via the link below."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Survey Link"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{value:c,readOnly:!0,className:"flex-1"}),e.jsx(g,{variant:"outline",size:"sm",onClick:l,className:"flex items-center gap-2",children:n?e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"w-4 h-4"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-4 h-4"}),"Copy"]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Send via Email (comma-separated)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{value:a,onChange:m=>o(m.target.value),placeholder:"email1@example.com, email2@example.com",className:"flex-1"}),e.jsxs(g,{variant:"default",size:"sm",onClick:u,className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Send"]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Note: Email sending requires backend integration"})]}),e.jsx("div",{className:"pt-4",children:e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Survey:"})," ",t.title]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",e.jsx("span",{className:"capitalize",children:t.status})]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Questions:"})," ",t.questions.length]})]})})]})]})]})}function Dt({survey:t,onEdit:s,onView:n,onPublish:r,onDelete:a}){const o=V(),{userRole:c}=B(),l=d=>{const f={[y.DRAFT]:"bg-gray-100 text-gray-700",[y.PUBLISHED]:"bg-green-100 text-green-700",[y.CLOSED]:"bg-blue-100 text-blue-700"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f[d]}`,children:d.charAt(0).toUpperCase()+d.slice(1)})},u=d=>{try{return new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch{return d}},m=()=>{const{teams:d,departments:f,roles:de,locations:ue}=t.targetAudience;return(d?.length||0)+(f?.length||0)+(de?.length||0)+(ue?.length||0)};return e.jsxs(R,{className:"hover:shadow-lg transition-shadow",children:[e.jsx(ye,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(je,{className:"text-lg line-clamp-2",children:t.title}),l(t.status)]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.purpose}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsxs("span",{children:[u(t.openDate)," - ",u(t.closeDate)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),e.jsxs("span",{children:[m()," audience groups"]})]}),e.jsxs("div",{className:"text-xs",children:[t.questions.length," question",t.questions.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[t.status===y.DRAFT&&e.jsxs(e.Fragment,{children:[Te(c)&&e.jsxs(g,{variant:"outline",size:"sm",onClick:s,className:"flex-1",children:[e.jsx(Ae,{className:"w-4 h-4 mr-1"}),"Edit"]}),M(c)&&e.jsxs(g,{variant:"default",size:"sm",onClick:r,className:"flex-1",children:[e.jsx(Ge,{className:"w-4 h-4 mr-1"}),"Publish"]}),Pe(c)&&e.jsx(g,{variant:"ghost",size:"sm",onClick:a,className:"text-destructive",children:e.jsx(ke,{className:"w-4 h-4"})})]}),t.status===y.PUBLISHED&&e.jsxs(e.Fragment,{children:[M(c)&&e.jsx(St,{survey:t}),$(c)&&e.jsxs(g,{variant:"outline",size:"sm",onClick:n,className:"flex-1",children:[e.jsx(Oe,{className:"w-4 h-4 mr-1"}),"Track"]})]}),t.status===y.CLOSED&&e.jsx(e.Fragment,{children:$(c)&&e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>o(j.SURVEYS.RESULTS.replace(":id",t.id)),className:"flex-1",children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),"Results"]})})]})]})]})}const Et=()=>{const t=G(),[s,n]=i.useState(""),r=_(H),a=i.useMemo(()=>{if(!s.trim())return r;const l=s.toLowerCase();return r.filter(u=>u.title.toLowerCase().includes(l)||u.purpose.toLowerCase().includes(l))},[r,s]);return{searchTerm:s,setSearchTerm:n,filteredSurveys:a,handlePublish:async l=>{try{await t(Ce(l)).unwrap(),x.success(U.SUCCESS.PUBLISHED)}catch(u){x.error(W(u,"Failed to publish survey"))}},handleDelete:async l=>{if(confirm("Are you sure you want to delete this survey? This action cannot be undone."))try{await t(Ne(l)).unwrap(),x.success(U.SUCCESS.DELETED)}catch(u){x.error(W(u,"Failed to delete survey"))}}}};function Mt(){const t=V(),s=G(),n=_(H),r=_(d=>d.survey.isLoading),{userRole:a}=B(),{searchTerm:o,setSearchTerm:c,filteredSurveys:l,handlePublish:u,handleDelete:m}=Et();return i.useEffect(()=>{s(O())},[s]),i.useEffect(()=>{s(O())},[s]),r&&n.length===0?e.jsx(He,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent",children:"Surveys"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and create surveys for your organization"})]}),Ie(a)&&e.jsxs(g,{onClick:()=>t(j.SURVEYS.CREATE),className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Create Survey"]})]}),e.jsx(R,{children:e.jsx(w,{className:"pt-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search surveys by title or purpose...",value:o,onChange:d=>c(d.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"})]})})}),l.length===0?e.jsx(R,{children:e.jsxs(w,{className:"py-12 text-center",children:[e.jsx("p",{className:"text-gray-500 mb-4",children:o?"No surveys match your search":"No surveys yet"}),!o&&e.jsxs(g,{onClick:()=>t(j.SURVEYS.CREATE),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),"Create Your First Survey"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(d=>e.jsx(Dt,{survey:d,onEdit:()=>t(j.SURVEYS.EDIT.replace(":id",d.id)),onView:()=>t(j.SURVEYS.TRACKING.replace(":id",d.id)),onPublish:()=>u(d.id),onDelete:()=>m(d.id)},d.id))})]})}export{Mt as default};
